# =======================================================================================
# MONITOR CONFIG
# =======================================================================================
monitorv2 {
  output = HDMI-A-1
  mode = 1920x1080@180
  position = auto
  scale = 1
  # cm = dcip3
  supports_hdr = true
  supports_wide_color = true
  bitdepth = 10
}

monitorv2 {
  output = eDP-1
  disabled = true
}

# =======================================================================================
# ENVIRONMENT VARIABLES
# =======================================================================================
# QT / Toolkit overrides
env = QT_QPA_PLATFORM,wayland;xcb
env = GDK_BACKEND,wayland,x11,*
env = SDL_VIDEODRIVER,wayland
env = CLUTTER_BACKEND,wayland

# XDG Specs
env = XDG_CURRENT_DESKTOP,Hyprland
env = XDG_SESSION_TYPE,wayland
env = XDG_SESSION_DESKTOP,Hyprland

# Theming
env = HYPRCURSOR_THEME,Future-Cyan-Hyprcursor_Theme
env = XCURSOR_THEME,Future-Cyan-Hyprcursor_Theme
env = HYPRCURSOR_SIZE,24
env = XCURSOR_SIZE,24

# Input Method Environment Variables
# env = GTK_IM_MODULE,fcitx
env = QT_IM_MODULE,fcitx
env = XMODIFIERS,@im=fcitx
env = QT_IM_MODULES,"wayland;fcitx"

# =======================================================================================
# AUTOSTART (EXEC-ONCE)
# =======================================================================================

# Portals: Must be restarted to pick up the env vars
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP
exec-once = pkill -9 xdg-desktop-portal-wlr xdg-desktop-portal-hyprland xdg-desktop-portal-gtk xdg-desktop-portal mpd
exec-once = sleep 1 && /usr/lib/xdg-desktop-portal-hyprland &
exec-once = sleep 2 && /usr/lib/xdg-desktop-portal-gtk &
exec-once = sleep 2 && /usr/lib/xdg-desktop-portal &

# Cleanup & Audio Stack
# exec-once = gentoo-pipewire-launcher &
exec-once = sleep 1 && mpd &
exec-once = sleep 1 && mpd-mpris &


# Clipboard Persist
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store

# Authentication Agent (Polkit)
exec-once = /usr/libexec/polkit-gnome-authentication-agent-1

# Set cursor
exec-once = hyprctl setcursor Future-Cyan-Hyprcursor_Theme 24

# Autostart Fcitx5 Daemon
exec-once = fcitx5 -d --replace

# System Apps
exec-once = hypridle
exec-once = swaybg -i $HOME/Pictures/Wallpaper/Minato-Aqua-Dark.png
exec-once = hyprsunset
exec-once = sleep 1; waybar
exec-once = brightnessctl set 10%
exec-once = mako
exec-once = emacs --daemon
exec-once = [workspace 9 silent;noanim] thunderbird

# =======================================================================================
# LOOK & FEEL (Catppuccin Mocha)
# =======================================================================================
general {
    border_size = 2
    col.active_border = rgb(89b4fa)
    col.inactive_border = rgb(313244)
    gaps_in = 0
    gaps_out = 0
    layout = dwindle
}

decoration {
    rounding = 0
    dim_inactive = false
    dim_strength = 0.7

    blur {
        enabled = true
        passes = 2
        size = 2
        new_optimizations = true
        xray = true
        ignore_opacity = true
    }

    shadow {
        enabled = false
        range = 8
        render_power = 3
    }
}

animations {
    enabled = true
    bezier = myBezier, 0.05, 0.9, 0.1, 1.05
    bezier = easeOutQuint, 0.23, 1, 0.32,1
    bezier = easeInOutCubic, 0.65, 0.05, 0.36, 1
    bezier = linear, 0, 0, 1, 1
    bezier = almostLinear, 0.5, 0.5, 0.75, 1.0
    bezier = quick, 0.15, 0, 0.1, 1

    animation = global, 1, 10, default
    animation = border, 1, 5.39, easeOutQuint
    animation = windows, 1, 4.79, easeOutQuint
    animation = windowsIn, 1, 4.1, easeOutQuint, popin 87%
    animation = windowsOut, 1, 1.49, linear, popin 87%
    animation = fadeIn, 1, 1.73, almostLinear
    animation = fadeOut, 1, 1.46, almostLinear
    animation = fade, 1, 3.03, quick
    animation = layers, 1, 3.81, easeOutQuint
    animation = layersIn, 1, 4, easeOutQuint, fade
    animation = layersOut, 1, 1.5, linear, fade
    animation = fadeLayersIn, 1, 1.79, almostLinear
    animation = fadeLayersOut, 1, 1.39, almostLinear
    animation = workspaces, 1, 1.94, almostLinear, fade
    animation = workspacesIn, 1, 1.21, almostLinear, fade
    animation = workspacesOut, 1, 1.94, almostLinear, fade
}

input {
    follow_mouse = 1
    kb_layout = us
    kb_options = ctrl:nocaps
    repeat_delay = 300
    repeat_rate = 30

    touchpad {
        disable_while_typing = true
        natural_scroll = true
    }
}

dwindle {
    force_split = 2
    preserve_split = true
    pseudotile = true
}

group {
    col.border_active = rgb(89b4fa)
    col.border_inactive = rgb(313244)
    groupbar {
        col.active = rgb(89b4fa)
        col.inactive = rgb(313244)
        render_titles = false
        text_color = rgb(cdd6f4)
    }
}

misc {
    background_color = rgb(1e1e2e)
    disable_hyprland_logo = false
    enable_anr_dialog = false
    disable_splash_rendering = true
    force_default_wallpaper = -1
}

xwayland {
    force_zero_scaling = true
}

# =======================================================================================
# WINDOW RULES
# =======================================================================================
# (Keep existing workspace rules as they are separate from windowrule syntax)
workspace = w[tv1]s[false], gapsout:0, gapsin:0
workspace = f[1]s[false], gapsout:0, gapsin:0


# General
windowrule = suppressevent maximize, class:.*
windowrule = nofocus, class:^$, title:^$, xwayland:1, floating:1, fullscreen:0, pinned:0

# Workspaces
windowrule = workspace 9, class:^(thunderbird|org.mozilla.Thunderbird)$
windowrule = workspace 8, class:^(whatsapp-for-linux)$
windowrule = workspace 7, class:^(qBittorrent|org.qbittorrent.qBittorrent)$

# Steam
windowrule = workspace 6, class:^(steam)$
windowrule = workspace 6, title:^(Sign in to Steam)$
windowrule = float, class:^(steam)$, title:^(Special Offers)$
windowrule = float, class:^(steam)$, title:^(Steam - News)$
windowrule = noinitialfocus, class:^(steam)$, title:^(Steam - News)$
windowrule = nofocus, class:^(steam)$, title:^(notificationtoasts_.*_desktop)$
windowrule = noinitialfocus, class:^(steam)$, title:^notificationtoasts.*
windowrule = nofocus, class:^(steam)$, title:^$

# Media
windowrule = workspace 5, class:^(spotify)$
windowrule = workspace 5, class:^(org.fooyin.fooyin)$
windowrule = workspace 5, class:^(tidal-hifi)$
windowrule = workspace 5, class:^(foobar2000.exe)$
windowrule = tile, class:^(foobar2000.exe)$
windowrule = noanim, class:^(foobar2000.exe)$

# Chat
windowrule = workspace 4, class:^(org.telegram.desktop)$
windowrule = noanim, class:^(org.telegram.desktop)$
windowrule = float, class:^(org.telegram.desktop)$, title:^(Media viewer)$

windowrule = workspace 3, title:^(.*(Disc|ArmC|WebC)ord.*)$
windowrule = noblur, title:^(.*(Disc|WebC)ord.*)$
windowrule = noshadow, title:^(.*(Disc|WebC)ord.*)$
windowrule = workspace 3, class:^(vesktop)$

# Browsers
$browsers = ^(brave-browser|firefox|firefox-esr|floorp|zen|zen-beta|Chromium-browser|chromium-browser)$
windowrule = workspace 2, class:$browsers
windowrule = noblur, class:$browsers
windowrule = noshadow, class:$browsers
windowrule = idleinhibit fullscreen, class:$browsers
windowrule = idleinhibit focus, class:$browsers, title:^(.*YouTube.*)$

# Dev & Games
windowrule = workspace 1, class:^(jetbrains-.*)$
windowrule = noblur, class:^(jetbrains-.*)$
windowrule = noanim, class:^(jetbrains-.*)$
windowrule = workspace 1, class:^(Albion-Online)$

# Floating / Misc
windowrule = float, title:^(Extension: \(Bitwarden Password Manager\))$
windowrule = nofocus, title:^notificationtoasts.*
windowrule = float, class:^(xdg-desktop-portal-gtk)$
windowrule = noblur, class:^(xdg-desktop-portal-gtk)$

# KeePassXC
windowrule = noblur, class:^(org.keepassxc.KeePassXC)$
windowrule = noanim, class:^(org.keepassxc.KeePassXC)$
windowrule = float, class:^(org.keepassxc.KeePassXC)$, title:^(Generate Password)$
windowrule = float, class:^(org.keepassxc.KeePassXC)$, title:^(KeePassXC - Browser Access Request)$

# =======================================================================================
# KEYBINDINGS
# =======================================================================================
$mod = SUPER

# Applications
bind = $mod, Return, exec, wezterm
bind = $mod, E, exec, emacsclient -c
bind = $mod SHIFT, E, exec, thunar
bind = $mod, M, exec, thunderbird
bind = $mod, P, exec, fuzzel
bind = $mod, D, exec, vesktop
bind = $mod, G, exec, firefox
bind = $mod SHIFT, G, exec, zen

# Utils (Clipboard & Screenshots)
bind = $mod, O, exec, ~/.config/hypr/clipboard-picker.sh
bind = $mod SHIFT, O, exec, fuzzmoji

# Screenshot (Using your bash script logic)
bind = , print, exec, ~/.config/hypr/wl-ocr.sh
bind = CTRL, Print, exec, grimblast save area - | swappy -f -
bind = ALT, Print, exec, bash -c 'file="$HOME/Pictures/Screenshots/$(date +"%Y-%m-%d_%H-%M-%S").png"; grim -g "$(slurp)" "$file"; wl-copy < "$file"; notify-send "Screenshot taken" "Saved to $file" -i "$file"'

# Window Management
bind = $mod, X, exec, wleave
bind = $mod, W, killactive
bind = $mod SHIFT, C, exit
bind = $mod, Q, togglespecialworkspace
bind = $mod SHIFT, Q, movetoworkspace, special
bind = $mod, F, fullscreen, 0
bind = $mod, Space, togglefloating
bind = $mod, R, togglegroup
bind = $mod SHIFT, J, changegroupactive, f
bind = $mod SHIFT, K, changegroupactive, b

# Focus & Move (Vim Style)
bind = $mod, h, movefocus, l
bind = $mod, l, movefocus, r
bind = $mod, k, movefocus, u
bind = $mod, j, movefocus, d

bind = $mod SHIFT, h, movewindow, l
bind = $mod SHIFT, l, movewindow, r
bind = $mod SHIFT, k, movewindow, u
bind = $mod SHIFT, j, movewindow, d

# Workspaces
bind = $mod, 1, workspace, 1
bind = $mod, 2, workspace, 2
bind = $mod, 3, workspace, 3
bind = $mod, 4, workspace, 4
bind = $mod, 5, workspace, 5
bind = $mod, 6, workspace, 6
bind = $mod, 7, workspace, 7
bind = $mod, 8, workspace, 8
bind = $mod, 9, workspace, 9
bind = $mod, 0, workspace, 10

bind = $mod SHIFT, 1, movetoworkspacesilent, 1
bind = $mod SHIFT, 2, movetoworkspacesilent, 2
bind = $mod SHIFT, 3, movetoworkspacesilent, 3
bind = $mod SHIFT, 4, movetoworkspacesilent, 4
bind = $mod SHIFT, 5, movetoworkspacesilent, 5
bind = $mod SHIFT, 6, movetoworkspacesilent, 6
bind = $mod SHIFT, 7, movetoworkspacesilent, 7
bind = $mod SHIFT, 8, movetoworkspacesilent, 8
bind = $mod SHIFT, 9, movetoworkspacesilent, 9
bind = $mod SHIFT, 0, movetoworkspacesilent, 10

# Media Keys (Wireplumber & Brightnessctl)
bindel = , XF86AudioRaiseVolume, exec, wpctl set-volume -l 1.5 @DEFAULT_AUDIO_SINK@ 5%+
bindel = , XF86AudioLowerVolume, exec, wpctl set-volume -l 1.5 @DEFAULT_AUDIO_SINK@ 5%-
bindel = , XF86AudioMute, exec, wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
bindel = , XF86AudioMicMute, exec, wpctl set-mute @DEFAULT_AUDIO_SOURCE@ toggle
bindel = , XF86MonBrightnessUp, exec, brightnessctl -e4 -n2 set 5%+
bindel = , XF86MonBrightnessDown, exec, brightnessctl -e4 -n2 set 5%-
bindl = , XF86AudioNext, exec, playerctl next
bindl = , XF86AudioPrev, exec, playerctl previous
bindl = , XF86AudioPlay, exec, playerctl play-pause
bindl = , XF86AudioPause, exec, playerctl play-pause

# Mouse
bindm = $mod, mouse:272, movewindow
bindm = $mod, mouse:273, resizewindow
