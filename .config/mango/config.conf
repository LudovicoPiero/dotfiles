# Monitor & Environment
exec-once = wlr-randr --output eDP-1 --off
exec-once = dbus-update-activation-environment --systemd WAYLAND_DISPLAY XDG_CURRENT_DESKTOP XDG_SESSION_TYPE
exec-once = /usr/libexec/polkit-gnome-authentication-agent-1

# Cleanup & Audio Stack
exec-once = pkill -9 xdg-desktop-portal-wlr xdg-desktop-portal-gtk xdg-desktop-portal pipewire wireplumber pipewire-pulse mpd
exec-once = gentoo-pipewire-launcher &
exec-once = sleep 1 && mpd &
exec-once = sleep 1 && mpd-mpris &

# Portals (Manual launch after DBus update)
exec-once = sleep 1 && /usr/libexec/xdg-desktop-portal-wlr &
exec-once = sleep 2 && /usr/libexec/xdg-desktop-portal-gtk &
exec-once = sleep 2 && /usr/libexec/xdg-desktop-portal &

# Hardware, UI & Apps
exec-once = brightnessctl set 10%
exec-once = swaybg -i $HOME/Pictures/Wallpaper/Minato-Aqua-Dark.png
exec-once = fcitx5 -d --replace
exec-once = mako
exec-once = waybar

# Clipboard
exec-once = wl-paste --type text --watch cliphist store
exec-once = wl-paste --type image --watch cliphist store

# Autostart Apps
exec-once = thunderbird-bin

# Environment Variables
env = MOZ_ENABLE_WAYLAND,1
env = QT_QPA_PLATFORM,wayland;xcb
env = XDG_SESSION_TYPE,wayland
env = XDG_CURRENT_DESKTOP,wlroots
env = XMODIFIERS,@im=fcitx
env = QT_IM_MODULE,fcitx
env = QT_IM_MODULES,wayland;fcitx
env = XCURSOR_SIZE,24
env = _JAVA_AWT_WM_NONREPARENTING,1
env = GDK_BACKEND,wayland,x11,*
env = SDL_VIDEODRIVER,wayland
env = CLUTTER_BACKEND,wayland

# Keyboard
repeat_rate = 30
repeat_delay = 300

# --- Appearance
blur = 1
shadows = 0
border_radius = 3
focused_opacity = 1.0
unfocused_opacity = 1.0
gappih = 2
gappiv = 2
gappoh = 4
gappov = 4
borderpx = 2
enable_hotarea = false

# Colors (Hex format)
rootcolor = 0x1e1e2eff
bordercolor = 0x585b70ff
focuscolor = 0x89b4faff

# --- Layouts
new_is_master = 1
default_mfact = 0.55
scroller_structs = 20
scroller_default_proportion = 0.8
sloppyfocus = 1

# --- Monitor Rules
monitorrule = HDMI-A-1,0.55,1,tile,0,1,0,0,1920,1080,180
# monitorrule = eDP-1,0.55,1,tile,0,1,1920,0,1366,768,60 # Disabled

# --- Window Rules
# Workspaces (Tags)
windowrule = tags:9,isopensilent:1,appid:^(thunderbird|thunderbird-esr)$
windowrule = tags:8,isopensilent:1,appid:^(whatsapp-for-linux)$
windowrule = tags:7,isopensilent:1,appid:^(qBittorrent|org.qbittorrent.qBittorrent)$
windowrule = tags:6,isopensilent:1,appid:^(steam)$
windowrule = tags:6,isopensilent:1,appid:^(steam)$,title:^(Sign in to Steam)$
windowrule = tags:5,isopensilent:1,appid:^(spotify)$
windowrule = tags:5,isopensilent:1,appid:(org.fooyin.fooyin)
windowrule = tags:5,isopensilent:1,appid:(tidal-hifi)
windowrule = tags:5,isopensilent:1,force_tile_state:1,isnoanimation:1,appid:^(foobar2000.exe)$
windowrule = tags:4,isopensilent:1,isnoanimation:1,appid:^(org.telegram.desktop)$
windowrule = tags:3,isopensilent:1,appid:^(vesktop)$
windowrule = tags:3,isopensilent:1,title:^(.*(Disc|ArmC|WebC)ord.*)$
windowrule = tags:2,isopensilent:1,noblur:1,isnoshadow:1,appid:^(brave-browser|firefox|firefox-esr|floorp|zen|zen-beta|Chromium-browser|chromium-browser)$
windowrule = tags:1,isopensilent:1,noblur:1,isnoanimation:1,appid:^(jetbrains-.*)$
windowrule = tags:1,isopensilent:1,appid:^(Albion-Online)$

# Communication & Social Tweaks
windowrule = isfloating:1,appid:^(org.telegram.desktop)$,title:^(Media viewer)$
windowrule = noblur:1,isnoshadow:1,title:^(.*(Disc|WebC)ord.*)$

# Steam Specifics
windowrule = isfloating:1,appid:^(steam)$,title:^(Special Offers)$
windowrule = isfloating:1,isopensilent:1,appid:^(steam)$,title:^(Steam - News)$
windowrule = isopensilent:1,appid:^(steam)$,title:^(notificationtoasts_.*_desktop)$
windowrule = isopensilent:1,appid:^(steam)$,title:(^notificationtoasts.*)
windowrule = isopensilent:1,appid:^(steam)$,title:^$

# Utilities & Floating
windowrule = isfloating:1,title:^(Extension: (Bitwarden Password Manager))$
windowrule = isopensilent:1,title:(^notificationtoasts.*)
windowrule = isfloating:1,noblur:1,appid:^(xdg-desktop-portal-gtk)$
windowrule = ignore_maximize:1,appid:.*

# KeePassXC
windowrule = noblur:1,isnoanimation:1,appid:^(org.keepassxc.KeePassXC)$
windowrule = isfloating:1,appid:^(org.keepassxc.KeePassXC)$,title:^(Generate Password)$
windowrule = isfloating:1,appid:^(org.keepassxc.KeePassXC)$,title:^(KeePassXC - Browser Access Request)$

# --- Key Bindings
bind = SUPER,r,reload_config
bind = SUPER,p,spawn,fuzzel
bind = SUPER,o,spawn,$HOME/.local/bin/clipboard-picker
bind = SUPER,g,spawn,firefox
bind = SUPER,f,togglefullscreen
bind = SUPER,Return,spawn,wezterm
bind = SUPER,x,spawn,wleave
bind = SUPER+SHIFT,x,quit
bind = SUPER,w,killclient,

# Screenshot Logic
bind = none,Print,spawn,$HOME/.local/bin/screenshot --full
bind = CTRL,Print,spawn,$HOME/.local/bin/screenshot --region
bind = SUPER,Print,spawn,wl-ocr
bind = ALT,Print,spawn,grimblast save area - | swappy -f -

# Brightness
bind = NONE, XF86MonBrightnessUp, spawn, brightnessctl set +5%
bind = NONE, XF86MonBrightnessDown, spawn, brightnessctl set 5%-

# Volume (via pipewire/pactl)
bind = NONE, XF86AudioRaiseVolume, spawn, pactl set-sink-volume @DEFAULT_SINK@ +5%
bind = NONE, XF86AudioLowerVolume, spawn, pactl set-sink-volume @DEFAULT_SINK@ -5%
bind = NONE, XF86AudioMute, spawn, pactl set-sink-mute @DEFAULT_SINK@ toggle
bind = NONE, XF86AudioMicMute, spawn, pactl set-source-mute @DEFAULT_SOURCE@ toggle

# Media Control (playerctl)
bind = NONE, XF86AudioPlay, spawn, playerctl play-pause
bind = NONE, XF86AudioPause, spawn, playerctl pause
bind = NONE, XF86AudioNext, spawn, playerctl next
bind = NONE, XF86AudioPrev, spawn, playerctl previous
bind = NONE, XF86AudioStop, spawn, playerctl stop

# Navigation
bind = SUPER,Tab,focusstack,next
bind = SUPER,h,focusdir,left
bind = SUPER,l,focusdir,right
bind = SUPER,k,focusdir,up
bind = SUPER,j,focusdir,down

# Workspaces (Tags)
bind = SUPER,1,view,1,0
bind = SUPER,2,view,2,0
bind = SUPER,3,view,3,0
bind = SUPER,4,view,4,0
bind = SUPER,5,view,5,0
bind = SUPER,6,view,6,0
bind = SUPER,7,view,7,0
bind = SUPER,8,view,8,0
bind = SUPER,9,view,9,0

bind = SUPER+SHIFT,1,tag,1,0
bind = SUPER+SHIFT,2,tag,2,0
bind = SUPER+SHIFT,3,tag,3,0
bind = SUPER+SHIFT,4,tag,4,0
bind = SUPER+SHIFT,5,tag,5,0
bind = SUPER+SHIFT,6,tag,6,0
bind = SUPER+SHIFT,7,tag,7,0
bind = SUPER+SHIFT,8,tag,8,0
bind = SUPER+SHIFT,9,tag,9,0

# Mouse
mousebind = SUPER,btn_left,moveresize,curmove
mousebind = SUPER,btn_right,moveresize,curresize
